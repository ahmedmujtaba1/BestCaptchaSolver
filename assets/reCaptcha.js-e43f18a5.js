import{a as Q,s as X,j as T}from"./utils-e474e5df.js";import"./package-b4497a7a.js";async function j(t){if(!t)throw new Error("A valid URL must be provided.");const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch URL. Status code: ${e.status}`);const v=await e.blob();return new Promise((S,q)=>{const p=new FileReader;p.onloadend=()=>{p.result?S(p.result.replace(/^data:image\/(png|jpeg);base64,/,"")):q(new Error("Failed to convert to base64"))},p.readAsDataURL(v)})}function Y(t){window.addEventListener("load",()=>{const e=document.body.appendChild(document.createElement("style")).sheet;e.insertRule(`.rc-imageselect-table-33, .rc-imageselect-table-42, .rc-imageselect-table-44 {transition-duration: ${1/t}s !important}`,0),e.insertRule(`.rc-imageselect-tile {transition-duration: ${4/t}s !important}`,1),e.insertRule(`.rc-imageselect-dynamic-selected {transition-duration: ${2/t}s !important}`,2),e.insertRule(`.rc-imageselect-progress {transition-duration: ${1/t}s !important}`,3),e.insertRule(`.rc-image-tile-overlay {transition-duration: ${1/t}s !important}`,4),e.insertRule("#rc-imageselect img {pointer-events: none !important}",5)})}function Z(){window.addEventListener("load",()=>{const e=document.body.appendChild(document.createElement("style")).sheet;e.insertRule(`.rc-imageselect-table-33, .rc-imageselect-table-42, .rc-imageselect-table-44 {transition-duration: ${1/2}s !important}`,0),e.insertRule(`.rc-imageselect-tile {transition-duration: ${4/2}s !important}`,1),e.insertRule(`.rc-imageselect-dynamic-selected {transition-duration: ${2/2}s !important}`,2),e.insertRule(`.rc-imageselect-progress {transition-duration: ${1/2}s !important}`,3),e.insertRule(`.rc-image-tile-overlay {transition-duration: ${1/2}s !important}`,4),e.insertRule("#rc-imageselect img {pointer-events: none !important}",5)})}(async()=>{function t(...r){e.logs&&console.log(...r)}let e=await chrome.storage.sync.get(null);const v="https://beta.nocaptchaai.com/solve",S={"Content-Type":"application/json",apikey:e.apikey},q=r=>document.querySelector(r);function p(){document.querySelector("#recaptcha-verify-button")?.click()}e.Rfast&&Y(2);class o{static time(){return Date.now||(Date.now=()=>new Date().getTime()),Date.now()}static date(){return new Date}static sleep(n=1e3){return new Promise(i=>setTimeout(i,n))}static async random_sleep(n,i){const u=Math.floor(Math.random()*(i-n)+n);return await o.sleep(u)}}function U(){return document.querySelector(".recaptcha-checkbox")!==null}function x(){return document.querySelector("#rc-imageselect")!==null}function I(){document.querySelector("#recaptcha-anchor")?.click()}async function W(){e.fast&&Z(),!D()&&(await o.sleep(500),I())}function O(){return document.querySelector(".rc-doscaptcha-header")!==null}function D(){const r=document.querySelector(".recaptcha-checkbox")?.getAttribute("aria-checked")==="true",n=document.querySelector("#recaptcha-verify-button")?.disabled;return r||n}function P(){const r=[".rc-imageselect-incorrect-response"];for(const n of r)if(document.querySelector(n)?.style.display==="")return!0;return!1}function M(){const r=[".rc-imageselect-error-select-more",".rc-imageselect-error-dynamic-more",".rc-imageselect-error-select-something"];for(const n of r){const i=document.querySelector(n);if(i?.style.display===""||i?.tabIndex===0)return!0}return!1}function N(){t("skipping"),q("#recaptcha-reload-button")?.click()}function V(r){try{return r.classList.contains("rc-imageselect-tileselected")}catch{}return!1}function z(r){return r?.src?.trim()}function C(){const r=document.querySelector(".rc-imageselect-desc strong,.rc-imageselect-desc-no-canonical strong")?.innerText;if(r)return r}function $(){return new Promise(async r=>{for(;;){await o.sleep(100);const n=document.querySelectorAll(".rc-imageselect-tile"),i=document.querySelectorAll(".rc-imageselect-dynamic-selected");if(n.length>0&&i.length===0)return r(!0)}})}function B(r=1e3){return new Promise(n=>{let i=!1;t("on_task_ready",i);const u=setInterval(async()=>{if(i)return;i=!0,t("on_task_ready",i);const b=document.querySelector(".rc-imageselect-instructions")?.innerText?.split(`
`);let f=await C();if(t("task",f),!f){i=!1;return}const d=b.length===3,a=document.querySelectorAll("table tr td");if(a.length!==9&&a.length!==16){t(a.length),i=!1;return}t("after cells",a.length);const g=[],c=Array(a.length).fill(null);let y=null,w=!1,R=0;for(const m of a){const l=m?.querySelector("img");if(!l){i=!1;return}const _=z(l);if(!_||_===""){i=!1;return}l.naturalWidth>=300?y=_:l.naturalWidth==100&&(c[R]=_,w=!0),g.push(m),R++}return t("has sec",w),w&&(y=null),clearInterval(u),i=!1,t(f,d,g,y,c),n({task:f,is_hard:d,cells:g,background_url:y,urls:c})},r)})}async function J(){const r=[...document.querySelectorAll('iframe[src*="/recaptcha/api2/anchor"]'),...document.querySelectorAll('iframe[src*="/recaptcha/enterprise/anchor"]')];if(r.length===0)return!1;for(const n of r)if(window.getComputedStyle(n).visibility==="visible")return await F(!0);return await F(!1)}async function F(r){return r}async function G(){const r=[...document.querySelectorAll('iframe[src*="/recaptcha/api2/bframe"]'),...document.querySelectorAll('iframe[src*="/recaptcha/enterprise/bframe"]')];if(r.length>0){for(const n of r)if(window.getComputedStyle(n).visibility==="visible")return!0;return!1}}async function H(){if(Q(".primary-controls","10px"),e.Rlogs&&t("on_image_frame"),O()){e.Rlogs&&t("rate limited");return}if(e.Rlogs&&t("not rate limited"),D()||(e.Rlogs&&t("not solved"),!E&&P()?(h=[],E=!0):E=!1,e.Rlogs&&t("not incorrect"),(M()||P())&&(h=[],N()),e.Rlogs&&t("not error"),!await $()))return;e.Rlogs&&t("images ready");const{task:n,is_hard:i,cells:u,background_url:b,urls:f}=await B();e.Rlogs&&t(n);const d=u.length==9?33:44;let a=[],g,c=[];if(b===null){g="split_33";for(let s=0;s<f.length;s++){const A=f[s],K=u[s];A&&!h.includes(A)&&(a[s]=await j(A),c.push(K))}e.Rlogs&&t(a)}else a.push(await j(b)),g=d,c=u,e.Rlogs&&t(c);if(a.length===0){t("image_urls",a.length),await X(1e3);return}a={...a};const y=o.time(),w=await C();e.Rlogs&&t("target",w);const R=await fetch(v,{method:"POST",headers:S,body:JSON.stringify({images:a,target:w,type:g,method:"recaptcha2"})});let m;try{m=await R.json()}catch(s){T("server Response error",s)}m.error==="Unauthorized"&&(window.alert(m.message),await o.sleep(3e3),window.open("https://dash.noCaptchaAi.com"));let l;try{l=m?.solution}catch(s){T("server Response error",s)}e.Rlogs&&t(l);const L=1500-(o.time()-y);L>0&&await o.sleep(L);let k=l?.length;e.Rlogs&&t("length",l.length),e.Rlogs&&t("clicks",k);for(let s of l)await m.status==="solved"&&!V(c[s])&&(c[s]?.click(),await o.sleep(300));for(const s of f)h.push(s),h.length>9&&h.shift();e.Rlogs&&t("n =",d,"is hard",i,"clicks = ",k,"onImageReady",await $()),(d===33&&i&&k===0&&await $()||d===33&&!i||d===44)&&(await o.sleep(200),p(),k=0)}let E=!1,h=[];for(;await o.sleep(1e3),!(!e.apikey||e.power===!1||e.reCap===!1);)await G(),await J(),e.RautoOpen&&U()?await W():e.RautoSolve&&x()&&await H()})();
