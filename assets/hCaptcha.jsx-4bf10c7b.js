import{c as A,v as z}from"./package-ccebe366.js";import{j as R,a as K}from"./utils-db674be6.js";let n=await chrome.storage.sync.get(null);await chrome.storage.sync.get(null);chrome.runtime.onMessage.addListener(function(r,b,w){if(r.action=="refresh_iframes")for(var d=document.getElementsByTagName("iframe"),p=0;p<d.length;p++)d[p].src=d[p].src});function Q(){if(!n.apikey)return;function r(){return document.querySelector(".task-answers")!==null}(async()=>{if(n.power===!1||n.hCap===!1)return;const b=e=>document.querySelector(e),w=n.logs;function d(e){w&&console.log("%cnoCaptchaAi.com ~ %c"+e,"background: #222; color: #bada55","")}function p(){const e=document.body.getBoundingClientRect();return e?.width===0||e?.height===0?!1:(K(),document.querySelector("div.check")!==null)}function a(e){return new Promise(t=>setTimeout(t,e))}function C(e,t){return Math.floor(Math.random()*(t-e)+e)}function O(){try{const e=document.querySelector("div.check");return e&&e.style.display==="block"}catch(e){return console.error(e),!1}}const P=()=>!navigator.onLine||X||n.apikey===void 0||n.apikey==="";async function M(e){const t=await(await fetch(e)).blob();return new Promise(function(s){const l=new FileReader;l.readAsDataURL(t),l.addEventListener("loadend",function(){s(l.result.replace(/^data:image\/(png|jpeg);base64,/,""))}),l.addEventListener("error",function(){d("❌ Failed to convert url to base64")})})}const[N]=A((await chrome.storage.sync.get("apikey")).apikey),[U,Y]=A((await chrome.storage.sync.get("plantype")).plantype);let k="",q="";const D=new URLSearchParams(location.hash),i=new XMLHttpRequest;i.open("GET","/server",!0),i.responseType="text",i.onload=()=>{i.readyState===i.DONE&&i.status===200&&(console.log(i.response),console.log(i.responseText))};const H=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("readystatechange",J),H.apply(this,arguments)};async function J(){if(!this.responseType!=""){if(!this.responseText)return;this.responseURL.startsWith("https://hcaptcha.com/getcaptcha")?(req_q=JSON.parse(this.responseText)?.requester_question,k=JSON.parse(this.responseText).requester_question?.en,q="en"):this.responseURL.endsWith(`getcaptcha/${D?.get("sitekey")}`)===!0&&(k=JSON.parse(this.responseText).requester_question?.en,q="en",w&&console.log("target_siteky filter",k))}}let T,X=!1;const B={"Content-Type":"application/json",apikey:N()};for(;!P();)if(await a(1e3),n.autoOpen&&p()){if(O()&&(w&&console.log("found solved"),n.hCAlwaysSolve===!1))break;await a(1e3),b("#checkbox")?.click()}else n.autoSolve&&b("h2.prompt-text")!==null&&(w&&d("opening box"),await W());function F(){const e=document.querySelector(".pseudo-cursor");e&&e.remove()}async function I(){document.querySelector(".display-language .text").textContent!=="EN"&&(await a(500),document.querySelector(".language-selector .option:nth-child(23)").click())}async function W(){n.magicMouse&&F();const{target:e,cells:t,images:s,example:l,choices:g}=await G();if(!n.autoSolve)return;T=new Date;const h=new URLSearchParams(location.hash);try{let o=await fetch($("solve"),{method:"POST",headers:B,body:JSON.stringify({images:s,target:e,method:"hcaptcha_base64",type:r()?"multi":"grid",choices:r()?g:[],sitekey:h.get("sitekey"),site:h.get("host"),ln:q!==""?"en":document.documentElement.lang||navigator.language,softid:`chromeExt_V${z}`})});o=await o.json();const v=C(300,450),u=_(o.solution);let f=0;if(n.logs&&console.table(o),o.error)console.log(o.message),R("⚠"+o.message);else if(o.status==="new"){if(r()){const c=o.answer;console.log(c,"res");for(const L in c){const y=[...document.querySelectorAll(".answer-text")].find(j=>c.some(S=>j.outerText===S));console.log(y.children?.outerText),E(y),await a(400),document.querySelector(".submit-button")?.click()}}else if(!r()){await a(2e3);const c=await(await fetch(o.url)).json();for(const L of c.solution)t[L].click(),await a(v)}}else if(o.status==="solved"){if(r()){const c=o.answer;console.log(c,"res");for(const L in c){const y=[...document.querySelectorAll(".answer-text")].find(S=>c.some(V=>S.outerText===V));console.log(y.children?.children?.outerText),await a(200),E(y),[...document.querySelectorAll(".answer-example")].some(S=>S.style.backgroundColor==="rgb(116, 116, 116)")||E(y),await a(500),f=1}console.log("multi hcap ~ clicks",f)}else if(!r())for(const c of u)t[c].click(),await a(v)}else o.status==="falied"&&(console.log(o.message),R("⚠"+o.message));const m=new Date-T,x=r()?n.hcaptime_multi:n.hcaptime*1e3-m;await a(x),document.querySelector(".button-submit").click(),T=0}catch(o){R("⚠Server issue, please try again later"),console.warn(o)}}function _(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function E(e){["mouseover","mousedown","mouseup","click"].forEach(t=>{if(e.fireEvent)e.fireEvent("on"+t);else{const s=document.createEvent("MouseEvents");s.initEvent(t,!0,!1),e.dispatchEvent(s)}})}function $(e){return"https://"+U()+".nocaptchaai.com/"+e}function G(e=500){return new Promise(async t=>{const s=setInterval(async function(){n.english&&(await I(),await a(500));let l=k||document.querySelector(".prompt-text")?.textContent;if(!l)return;let g=null,h={},o={},v=[];if(r()){if(r()){const u=document.querySelector(".task-image .image-wrapper .image")?.style.background;let f="";try{f=await M(u.match(/url\("(.*)"/)?.at(1))||""}catch(x){console.log(x)}if(!o)return;Object.assign(h,{[Object.keys(h).length]:f});const m=document.querySelectorAll(".answer-text");v=Array.from(m).map(x=>x.outerText)}}else{if(g=document.querySelectorAll(".task-image .image"),g.length!==9)return;for(let u=0;u<g.length;u++){const f=g[u];if(!f)return;const m=f.style.background.match(/url\("(.*)"/)?.at(1)||null;if(!m||m==="")return;h[u]=await M(m)}}return clearInterval(s),t({target:l,cells:g,images:h,example:o,choices:v})},e)})}})()}Q();
